<html><head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>takeMutableSnapshot</title>
</head><body><link href="../../../../../../../../../../images/logo-icon.svg" rel="icon" type="image/svg"><script>var pathToRoot = "../../../../../../";</script><script type="text/javascript" src="../../../../../../scripts/sourceset_dependencies.js" async></script><link href="../../../../../../styles/style.css" rel="Stylesheet"><link href="../../../../../../styles/logo-styles.css" rel="Stylesheet"><link href="../../../../../../styles/jetbrains-mono.css" rel="Stylesheet"><link href="../../../../../../styles/main.css" rel="Stylesheet"><script type="text/javascript" src="../../../../../../scripts/clipboard.js" async></script><script type="text/javascript" src="../../../../../../scripts/navigation-loader.js" async></script><script type="text/javascript" src="../../../../../../scripts/platform-content-handler.js" async></script><script type="text/javascript" src="../../../../../../scripts/main.js" async></script>
  
    <div id="container">
      <div id="leftColumn"><a href="../../../../../../index.html">
            <div id="logo"></div>
          </a>
        <div id="paneSearch"></div>
        <div id="sideMenu"></div>
      </div>
      <div id="main">
        <script type="text/javascript" src="../../../../../../scripts/main.js"></script><div id="leftToggler"><span class="icon-toggler"></span></div>

        <div class="main-content" id="content" pageids="runtime::androidx.compose.runtime.snapshots/Snapshot.Companion/takeMutableSnapshot/#kotlin.Function1[kotlin.Any,kotlin.Unit]?#kotlin.Function1[kotlin.Any,kotlin.Unit]?/PointingToDeclaration//-59835339">
          <div class="navigation-wrapper" id="navigation-wrapper">
            <div class="breadcrumbs"><a href="../../../../index.html">runtime</a>/<a href="../../index.html">androidx.compose.runtime.snapshots</a>/<a href="../index.html">Snapshot</a>/<a href="index.html">Companion</a>/<a href="take-mutable-snapshot.html">takeMutableSnapshot</a></div>
            <div class="pull-right d-flex">
              <div class="filter-section" id="filter-section"><button class="platform-tag platform-selector common-like" data-active="" data-filter=":compose:runtime:dokkaHtmlPartial/commonMain">common</button></div>
              <div id="searchBar"></div>
            </div>
          </div>
          <div class="cover ">
            <h1 class="cover"><span>take</span><wbr><span>Mutable</span><wbr><span>Snapshot</span></h1>
          </div>
<div class="divergent-group" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="with-platform-tags"><span class="pull-right"></span></div>

  <div>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="symbol monospace">fun <a href="take-mutable-snapshot.html">takeMutableSnapshot</a>(readObserver: (<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html">Any</a>) -&gt; <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a>? = null, writeObserver: (<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html">Any</a>) -&gt; <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a>? = null): <a href="../../-mutable-snapshot/index.html">MutableSnapshot</a><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div></div>
  </div>
<p class="paragraph">Take a snapshot of the current value of all state objects that also allows the state to be changed and later atomically applied when <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> is called. The values are preserved until <a href="../dispose.html">Snapshot.dispose</a> is called on the result. The global state will either see all the changes made as one atomic change, when <a href="../../-mutable-snapshot/apply.html">MutableSnapshot .apply</a> is called, or none of the changes if the mutable state object is disposed before being applied.</p><p class="paragraph">The values in a snapshot can be modified by calling <a href="../enter.html">Snapshot.enter</a> and then, in its lambda, modify any state object. The new values of the state objects will only become visible to the global state when <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> is called.</p><p class="paragraph">An active snapshot (after it is created but before <a href="../dispose.html">Snapshot.dispose</a> is called) requires resources to track the values in the snapshot. Once a snapshot is no longer needed it should disposed by calling <a href="../dispose.html">Snapshot.dispose</a>.</p><p class="paragraph">Leaving a snapshot active could cause hard to diagnose memory leaks as values are maintained by state objects for these unneeded snapshots. Take care to always call <a href="../dispose.html">Snapshot.dispose</a> on all snapshots when they are no longer needed.</p><p class="paragraph">A nested snapshot can be taken by calling <a href="../take-nested-snapshot.html">Snapshot.takeNestedSnapshot</a>, for a read-only snapshot, or <a href="../../-mutable-snapshot/take-nested-mutable-snapshot.html">MutableSnapshot.takeNestedMutableSnapshot</a> for a snapshot that can be changed. Nested mutable snapshots are applied to the this, the parent snapshot, when their <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> is called. Their applied changes will be visible to in this snapshot but will not be visible other snapshots (including other nested snapshots) or the global state until this snapshot is applied by calling <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a>.</p><p class="paragraph">Once <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> is called on this, the parent snapshot, all calls to <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> on an active nested snapshot will fail.</p><p class="paragraph">Changes to a mutable snapshot are isolated, using snapshot isolation, from all other snapshots. Their changes are only visible as global state or to new snapshots once <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> is called.</p><p class="paragraph">Applying a snapshot can fail if currently visible changes to the state object conflicts with a change made in the snapshot.</p><p class="paragraph">When in a mutable snapshot, <a href="take-mutable-snapshot.html">takeMutableSnapshot</a> creates a nested snapshot of the current mutable snapshot. If the current snapshot is read-only, an exception is thrown. The current snapshot is the result of calling <a href="../../../../../../compose/runtime/androidx.compose.runtime.snapshots/index.html">currentSnapshot</a> which is updated by calling <a href="../enter.html">Snapshot.enter</a> which makes the <a href="../index.html">Snapshot</a> the current snapshot while in its lambda.</p><p class="paragraph">Composition uses mutable snapshots to allow changes made in a <a href="../../../androidx.compose.runtime/-composable/index.html">Composable</a> functions to be temporarily isolated from the global state and is later applied to the global state when the composition is applied. If <a href="../../-mutable-snapshot/apply.html">MutableSnapshot.apply</a> fails applying this snapshot, the snapshot and the changes calculated during composition are disposed and a new composition is scheduled to be calculated again.</p><h2 class="">See also</h2><div data-togglable="See also"><div class="platform-hinted WithExtraAttributes" data-platform-hinted="data-platform-hinted" data-togglable="See also"><div class="content sourceset-depenent-content" data-active="" data-togglable=":compose:runtime:dokkaHtmlPartial/commonMain"><div data-togglable="See also"><div class="table" data-togglable="See also"><div class="table-row" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue WithExtraAttributes RowTitle"><div class=""><span class="inline-flex"><a href="take-snapshot.html">androidx.compose.runtime.snapshots.Snapshot.Companion</a></span><span class="inline-flex"><div data-togglable="See also"></div></span></div><div></div></div></div><div class="table-row" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue WithExtraAttributes RowTitle"><div class=""><span class="inline-flex"><a href="../index.html">androidx.compose.runtime.snapshots.Snapshot</a></span><span class="inline-flex"><div data-togglable="See also"></div></span></div><div></div></div></div><div class="table-row" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue WithExtraAttributes RowTitle"><div class=""><span class="inline-flex"><a href="../../-mutable-snapshot/index.html">androidx.compose.runtime.snapshots.MutableSnapshot</a></span><span class="inline-flex"><div data-togglable="See also"></div></span></div><div></div></div></div></div></div></div></div></div><h2 class="">Parameters</h2><div data-togglable="Parameters"><div class="platform-hinted WithExtraAttributes" data-platform-hinted="data-platform-hinted" data-togglable="Parameters"><div class="content sourceset-depenent-content" data-active="" data-togglable=":compose:runtime:dokkaHtmlPartial/commonMain"><div data-togglable="Parameters"><div class="table" data-togglable="Parameters"><div class="table-row" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">readObserver</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">called when any state object is read in the lambda passed to <a href="../enter.html">Snapshot.enter</a> or in the <a href="../enter.html">Snapshot.enter</a> of any nested snapshots.</p><p class="paragraph">Composition, layout and draw use <a href="take-mutable-snapshot.html">readObserver</a> to implicitly subscribe to changes to state objects to know when to update.</p></div></div></div></div></div><div class="table-row" data-filterable-current=":compose:runtime:dokkaHtmlPartial/commonMain" data-filterable-set=":compose:runtime:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue WithExtraAttributes"><div class=""><span class="inline-flex">writeObserver</span></div><div><div class="title"><div data-togglable="Parameters"><p class="paragraph">called when a state object is created or just before it is written to the first time in the snapshot or a nested mutable snapshot. This might be called several times for the same object if nested mutable snapshots are created.</p><p class="paragraph">Composition uses <a href="take-mutable-snapshot.html">writeObserver</a> to track when a state object is modified during composition in order to invalidate the reads that have not yet occurred. This allows a single pass of composition for state objects that are written to before they are read (such as modifying the value of a dynamic ambient provider).</p></div></div></div></div></div></div></div></div></div></div></div>
        </div>
        <div class="footer"><span class="go-to-top-icon"><a href="#content"></a></span><span>© 2021 Copyright</span><span class="pull-right"><span>Generated by </span><a href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span></div>
      </div>
    </div>
  


</body></html>
